<app-alert *ngIf="errorMessage" [text]="errorMessage"></app-alert>
<div *ngIf="!errorMessage" style="height: 63px"></div>

<form [formGroup]="form" class="flex flex-col">
  <div class="w-full mb-4">
    <label for="email" class="block mb-1 text-sm font-medium text-gray-700">
      Sähköposti
    </label>

    <div class="relative">
      <!-- Left: Mail icon inside the input -->
      <span
        class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-400"
      >
        <mat-icon class="material-icons-outlined text-xl">mail</mat-icon>
      </span>

      <!-- Input field -->
      <input
        id="email"
        type="email"
        formControlName="email"
        maxlength="40"
        autocomplete="email"
        placeholder="sinun@sähköposti.com"
        class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900"
      />
    </div>

    <!-- Error messages -->
    <div
      *ngIf="
        form.get('email')?.invalid &&
        (form.get('email')?.touched || form.get('email')?.dirty)
      "
      class="mt-1 text-sm text-red-600"
    >
      <div *ngIf="form.get('email')?.errors?.['required']">
        Sähköposti on pakollinen
      </div>
      <div *ngIf="form.get('email')?.errors?.['email']">
        Syötä aito sähköposti osoite
      </div>
    </div>
  </div>
  <div class="w-full mb-4">
    <label for="password" class="block mb-1 text-sm font-medium text-gray-700">
      Salasana
    </label>

    <div class="relative">
      <span
        class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-400"
      >
        <mat-icon class="material-icons-outlined" matPrefix>lock</mat-icon>
      </span>

      <!-- Input field -->
      <input
        id="password"
        [type]="showPassword ? 'text' : 'password'"
        formControlName="password"
        maxlength="40"
        placeholder="Salasanasi"
        autocomplete="current-password"
        class="w-full pl-10 pr-10 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900"
      />

      <!-- Right: Toggle visibility -->
      <button
        type="button"
        (click)="showPassword = !showPassword"
        class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 focus:outline-none"
      >
        <mat-icon class="material-icons-outlined text-xl">
          {{ showPassword ? "visibility" : "visibility_off" }}
        </mat-icon>
      </button>
    </div>

    <!-- Error messages -->
    <div
      *ngIf="
        form.get('password')?.invalid &&
        (form.get('password')?.touched || form.get('password')?.dirty)
      "
      class="mt-1 text-sm text-red-600"
    >
      <div *ngIf="form.get('password')?.errors?.['required']">
        Password is required
      </div>
    </div>
  </div>

  <!-- <mat-form-field appearance="outline">
    <mat-error *ngIf="form.get('password')?.hasError('required')"
      >Password is required</mat-error
    >
    <mat-label>Password</mat-label>
    <input
      matInput
      maxlength="40"
      [type]="showPassword ? 'text' : 'password'"
      formControlName="password"
    />
    <mat-icon class="material-icons-outlined" matPrefix>lock</mat-icon>
    <mat-icon
      matSuffix
      (click)="showPassword = !showPassword"
      class="toggleShowPasswordButton material-icons-outlined"
      >{{ showPassword ? "visibility" : "visibility_off" }}</mat-icon
    >
  </mat-form-field> -->

  <button
    mat-raised-button
    mat-button
    color="primary"
    (click)="submit()"
    [disabled]="this.form.invalid"
    *ngIf="!isLoading"
  >
    Login
  </button>

  <button *ngIf="isLoading" mat-raised-button color="primary" disabled>
    <app-loading-spinner [diameter]="30"></app-loading-spinner>
  </button>

  <!-- <span
    >Dont have an account?
    <b color="primary" routerLink="/register">Create Account</b></span
  > -->
</form>
